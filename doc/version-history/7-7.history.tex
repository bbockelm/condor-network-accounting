%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\label{sec:History-7-7}Development Release Series 7.7}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This is the development release series of Condor.
The details of each version are described below.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-7-6}Version 7.7.6}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Condor version 7.7.6 released on April 24, 2012.
This release contains all bug fixes from Condor version 7.6.7,
as listed in this manual's version history. 

\item In the Condor directory defined by \MacroUNI{SBIN},
\File{condor\_vm\_vmware.pl} was
renamed to \File{condor\_vm\_vmware} and \File{grid\_monitor.sh} was
renamed to \File{grid\_monitor}.
This makes Condor more compliant with Linux native packaging rules.
Symbolic links to the old locations are included to ease upgrading.
\Ticket{2940}

\end{itemize}


\noindent New Features:

\begin{itemize}

\item The values of \SubmitCmd{request\_memory}, \SubmitCmd{request\_disk} and
\SubmitCmd{request\_cpus} submit description file commands will now be
automatically included in the job \Attr{Requirements} expression by
\Condor{submit}.  This is part of several changes
in code and policy intended to make partitionable slots easier to deploy
and use.  The requested values for memory, disk and cpus, as well as the
amount of these resources that a job actually uses are now printed in the
user log when the job exits.
\Ticket{2843}

\item The new \SubmitCmd{keep\_claim\_idle} submit description
file command requests that the \Condor{schedd} keep a claim for a defined
number of seconds after the job exits.
The job ClassAd attribute \Attr{KeepClaimIdle} was introduced in
Condor version 7.7.1 to implement this functionality.
See the definition of this command at 
section ~\ref{condor-submit-keep-claim-idle}.
\Ticket{2094}

\item Changed the default for \Condor{history} to print out
items in reverse chronological order.  
The new \Opt{-forwards} option enables the previous behavior of 
printing historical jobs in chronological order.
\Ticket{2808}

\item Enhanced the \Condor{negotiator} to provide the name of 
concurrency limits that cause negotiation to fail, so that 
\Condor{q} -analyze can provide more informative failure information.
\Ticket{2878}

\item Concurrency limit defaults may now be declared for named groups
using \Macro{CONCURRENCY\_LIMIT\_DEFAULT\_<group>} so that any
concurrency limit with a name of the form <group>.<name> will get its
default limit from \Macro{CONCURRENCY\_LIMIT\_DEFAULT\_<group>}.
\Ticket{2863}

\item Condor binaries will now look for the Condor configuration file in
\File{\$(HOME)/.condor/condor\_config}, in addition to the locations where
they already look.
Within the ordered search,
\File{\$(HOME)/.condor/condor\_config} is checked immediately after the 
\Env{CONDOR\_CONFIG} environment variable.
\Ticket{2657}

\item The \Condor{hdfs} daemon is now available with the source code,
and is no longer distributed as part of the Condor binaries.
See documentation in section ~\ref{sec:Condor-HDFS}.
\Ticket{2797}

\item Several of the Condor programs used to be given by a single executable
hard linked to multiple file names. 
Now, symbolic links are used; this fixes problems with Debian installations.
\Ticket{2140}

\item New ClassAd functions \Procedure{pow}, \Procedure{quantize},
\Procedure{splitUserName}, and \Procedure{splitSlotName} are available.
See section ~\ref{sec:classadFunctions} for definitions of these functions.
\Ticket{2856}
\Ticket{2891}

\item New format tags \%v and \%V have been added for use by the
\Condor{status} \Opt{-format} option.
These tags request that the value of the expression or attribute be printed 
using a format appropriate to its type.
When using the \%V format tag, string values appear as they would in
the output of \condor{q -long} or \condor{submit -long}.
\Ticket{2857}

\item \Condor{ssh\_to\_job} now provides support for X11 forwarding
via the new \Opt{-X} option.

\end{itemize}

\noindent Configuration Variable and ClassAd Attribute Additions and Changes:

\begin{itemize}

\item The new machine ClassAd attributes \Attr{RemoteGroup}, 
\Attr{RemoteNegotiatingGroup}, and \Attr{RemoteAutoregroup},
and the new job ClassAd attributes \Attr{SubmitterGroup}, 
\Attr{SubmitterNegotiatingGroup}, and \Attr{SubmitterAutoregroup}
enhance support for preemption policies with accounting group awareness.
\Ticket{2885}

\item The new configuration variable
\Macro{NEGOTIATOR\_READ\_CONFIG\_BEFORE\_CYCLE} is a boolean which causes the
\Condor{negotiator} to re-read the configuration prior to each
negotiation cycle when set to \Expr{True}.
\Ticket{2851}

\item The new configuration variable \Macro{MASTER\_NEW\_BINARY\_RESTART} 
specifies how the \Condor{master} will restart,
when it notices that the \Condor{master} binary has changed. 
Valid values are \Expr{GRACEFUL}, \Expr{PEACEFUL} and \Expr{NEVER}. 
The default value is \Expr{GRACEFUL}.
\Ticket{2779}

\item The configuration variable \MacroNI{WANT\_HOLD} now takes effect
whether or not \MacroNI{WANT\_VACATE} is \Expr{True}.  Previously,
it only took effect if \MacroNI{WANT\_VACATE} was \Expr{True}.
\Ticket{2855}

\item The new configuration variables \Macro{MEMORY\_USAGE\_METRIC} and
\Macro{MEMORY\_USAGE\_METRIC\_VM} specify the value that the 
\Condor{starter} will
set into the \Attr{MemoryUsage} attribute for a job.  It is expected that
this will be a ClassAd expression that defines the job memory usage in terms
of other job attributes.
\Ticket{2843}

\item The configuration variable \Macro{DAGMAN\_SUBMIT\_DELAY} can now be any
non negative integer.  It was formerly limited to values between 0 and 60,
inclusive.
\Ticket{2864}

\item New configuration variables have been added, 
such that the \Condor{schedd} may
define statistics that count subsets of jobs. 
These variables
have the form \Macro{SCHEDD\_COLLECT\_STATS\_FOR\_<name>} and 
are defined by a boolean ClassAd expression.
<name> will be prefixed to the names of attributes in the \Condor{schedd} 
ClassAd, such as \Attr{physicsJobsStarted}
where \MacroNI{SCHEDD\_COLLECT\_STATS\_FOR\_physics} evaluates to \Expr{True},
and this attribute would be the count of jobs that have started.
\Ticket{2862}

\item Several OpSys related attributes were added or updated to assist with selection of execute resources.
\begin{description}
\item [\AdAttr{OpSysAndVer}:] A string containing the value of the \Attr{OpSysName} attribute with the \Attr{OpSysMajorVersion} attribute appended.
\item [\AdAttr{OpSysLegacy}:] A string that holds the long-standing values for the \Attr{OpSys} attribute.
\item [\AdAttr{OpSysLongName}:] A string containing a full description of the operating system.
\item [\AdAttr{OpSysMajorVersion}:] An integer value representing the major version of the operating system.
\item [\AdAttr{OpSysName}:] A string containing a terse description of the operating system.
\item [\AdAttr{OpSysShortName}:] A string containing a short description of the operating system.
\item [\AdAttr{OpSysVer}:] An integer value representing the operating system version number.
\end{description}
\Ticket{2366}

\item New configuration variables have been added to provide default values for attributes needed to provision
dynamic slots. \Condor{submit} will insert the values of these variables into the job ClassAd when the submit
file does not provide a value for the attribute.
\begin{description}
\item [\AdAttr{RequestMemory}:] specified by \Macro{JOB\_DEFAULT\_REQUESTMEMORY}, defaults to \Attr{MemoryUsage}.
\item [\AdAttr{RequestDisk}:] specified by \Macro{JOB\_DEFAULT\_REQUESTDISK}, defaults to \Attr{DiskUsage}.
\item [\AdAttr{RequestCpus}:] specified by \Macro{JOB\_DEFAULT\_REQUESTCPUS}, defaults to 1.
\end{description}
\Ticket{2835}

\item New configuration variables have been added for the \Condor{startd} to enable default rules for partitionable
resources. The configuration variables are expected to be expressions that quantize or otherwise modify the job's
requested sizes of resources.
\begin{description}
\item [\AdAttr{RequestMemory}:] modify with \Macro{MODIFY\_REQUEST\_EXPR\_REQUESTMEMORY}.
\item [\AdAttr{RequestDisk}:] modify with\Macro{MODIFY\_REQUEST\_EXPR\_REQUESTDISK}.
\item [\AdAttr{RequestCpus}:] modify with \Macro{MODIFY\_REQUEST\_EXPR\_REQUESTCPUS}.
\end{description}
\item
\Ticket{2850}

\item There is a new configuration variable \Macro{MUST\_MODIFY\_REQUEST\_EXPRS} for the \Condor{startd}.
If false, then \MacroNI{MODIFY\_REQUEST\_EXPRs} are only applied if the job claim still matches the partitionable
slot after modification. If true, the modifications always take place, and if the modifications cause the claim
to no longer match, then the startd will simply refuse the claim.  The default value is false.
\Ticket{2850}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug in \Condor{vm-gahp} that caused 64-bit guest OSes that
need network access to fail on start-up when run under VMware.
\Ticket{2922}

\item Submit command \Macro{remote\_initialdir} now works for pbs and lsf
grid universe jobs.
\Ticket{2913}

\item Fixed the path to \Prog{sftp\_server} on Mac OS X and Debian
platforms.
\Ticket{2789}

\item Fixed a rare problem that caused a 20 second timeout to occur in
the \Condor{collector} when authenticating.
\Ticket{2817}

\item Fixed a rare bug in which the \Condor{schedd} would sometimes not reuse
an existing claim to run a new job when an existing job exited.  
This would result in the \Condor{schedd} daemon
waiting for a new negotiation cycle to make a new match,
and thus producing a small performance penalty due to the
wasted time during the interval between negotiation cycles.  
This bug was actually fixed in Condor version 7.7.5.
\Ticket{2802}

\item Fixed a bug in \Condor{q}, such that it no longer emits a parse
error when it times out attempting to talk to the \Condor{schedd} daemon.
\Ticket{2854}

\item The shared library \File{libcondor\_utils} now includes the Condor
version in its name. This will reduce the chance of a Condor binary
using the wrong version of the library, which can result in a crash or
other bad behavior.
\Ticket{2613}

\item There was a bug on GRACEFUL and PEACEFUL shutdown, 
as the daemons were stopped in a random order. 
This resulted in the checkpoint server 
sometimes being shut down before the \Condor{startd}.  
The \Condor{startd} is now always shut down first on GRACEFUL or PEACEFUL 
shutdown, 
with other daemons being shut down only after the \Condor{startd} has exited.
\Ticket{2779}

\item Under some circumstances, 
a job in the removed ("X") state may have ignored the \Opt{-forcex} option 
to \Condor{rm}.
The \Condor{schedd} is now more aggressive about removing such jobs 
from the queue.
\Ticket{2809}

\item Fixed the copying of scaling factors on ClassAd literal values.
\Ticket{2839}

\item When a job is killed and put on hold because of
  \MacroNI{WANT\_HOLD}, the maximum vacate time is now enforced.  If
  it takes longer than the maximum vacate time for the job to be
  gracefully killed, the job is hard-killed.  Previously, no upper
  limit was enforced.
\Ticket{2855}

\item When selecting an IPv4 network interface to use Condor would erroneously prefer private networks over public networks in some cases.  This has been fixed, Condor again prefers public networks over private networks.
\Ticket{2853}

\item The \condor{gridmanager} is much better at sending commit signals
to the GRAM job-manager in a timely manner. As a result, the occurrence of
GRAM errors 111 and 130 should be greatly reduced.
\Ticket{2859}

\item Fixed a bug that caused \condor{submit} to warn about
\MacroNI{dag\_status} and \MacroNI{failed\_count} not being used in the
submit files of most DAG node jobs (DAGMan now automatically defines
these macros for all node jobs).  This bug was introduced in 7.7.5.
\Ticket{2814}

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item The \Condor{submit} man page contains descriptions of \Condor{starter}
prescripts and postscripts.
See ~\ref{man-condor-submit-prescript} and ~\ref{man-condor-submit-postscript}
for the descriptions.
\Ticket{2379}

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-7-5}Version 7.7.5}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Condor version 7.7.5 released on February 28, 2012.
This release contains all features and bug fixes from Condor version 7.6.6. 

\item Support for the gt4 grid type (that is, Web Services GRAM) in the grid
universe has been removed.
\Ticket{2782}

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Condor now has experimental support for IPv6.  
This functionality is disabled by default.  
This support has a variety of limitations, 
including a lack of support for security, DNS, and mixed IPv4/IPv6 networks.  
For information on enabling IPv6 support in the 7.7 series of Condor, 
see \URL{https://condor-wiki.cs.wisc.edu/index.cgi/wiki?p=HowToEnableIpvSix}.
\Ticket{9}

\item Default values for the submit commands
\SubmitCmd{should\_transfer\_files} and \SubmitCmd{when\_to\_transfer\_output}
were introduced in Condor version 7.7.3,
but the manual did not reflect this change.
Across platforms, default values are now
\begin{verbatim}
  should_transfer_files = IF_NEEDED
  when_to_transfer_output = ON_EXIT
\end{verbatim}
See section ~\ref{sec:file-transfer-if-when} for details.
\Ticket{2281}
\Ticket{2273}

\item The performance for claiming a partitionable slot in a 
\Condor{startd} is greatly improved.  
This feature is implemented in both the \Condor{schedd} and \Condor{startd},
so both sides must be updated to at least Condor version 7.7.5 
to see the benefit.  
To disable this feature, set configuration variable
\Macro{CLAIM\_PARTITIONABLE\_LEFTOVERS} to \Expr{False} 
on either the submit or execute machines.  
The default value for this variable is \Expr{True}.
\Ticket{2790}

\item On Linux platforms, the \Condor{starter} can now optionally measure the
PSS (Proportional Set Size) of each Condor job,
if the configuration variable \Macro{USE\_PSS} is \Expr{True}.
Previously, this measurement was unconditionally on,
which can cause performance problems in the \Condor{procd} when running
many short lived jobs.
\Ticket{2710}

\item On Linux systems, the \Condor{starter} now has an ability to run a 
job under a chroot directory.  
If the configuration variable \Macro{NAMED\_CHROOT} is set to a list
of directories on an execute machine, 
the job has attribute \Attr{RequestedChroot} defined,
and the value of \Attr{RequestedChroot} matches an entry 
in the list defined by \MacroNI{NAMED\_CHROOT},
then the \Condor{starter} calls \Procedure{chroot} with that directory 
as an argument.  
Note that it is up to the administrator to provide a full environment 
for the job to run in.
\Ticket{2698}

\item On Linux platforms which support a bind type of file system mount 
(which are generally RHEL 5 systems and more recent platforms), 
the administrator can configure the \Condor{startd} 
to provide per-job file system mounts.  
One use might be to provide each job its own view of \File{/tmp} 
and \File{/var/tmp}, which are private to that Condor job,
and cleared when the job exits.  
This is implemented with the new \Macro{MOUNT\_UNDER\_SCRATCH} 
configuration variable, which describes which directories to bind mount.
\Ticket{2015}

\item Added the new \Opt{-expand} option to \Condor{config\_val}.
If both \Opt{-dump} and \Opt{-expand} options are specified,
all configuration variables are expanded before they are printed out.
\Ticket{2687}

\item The \Opt{-sort} option for \Condor{status} has been generalized to
accept expressions instead of just simple named attributes.
\Ticket{2661}

\item A new command \Condor{drain} may be used to control the draining
of an execute machine.  While a machine is draining, no new jobs may
start.  Once draining is complete, it enters the Drained/Idle state.
For more details, see page~\pageref{man-condor-drain}.
\Ticket{2330}

\item A new daemon \Condor{defrag} has been added to automate a simple
policy for draining machines.  For more details, see
page~\pageref{sec:Config-defrag}.
\Ticket{2330}

\item  \Condor{q} \Opt{-run} now displays the value of the job ClassAd
attribute \Attr{EC2RemoteVirtualMachineName} instead of
\Expr{[????????????????]},
under the HOST(S) column for grid type ec2 jobs.
\Ticket{2599}

\item Condor can now submit jobs to Grid Engine via the new sge grid type.
See section ~\ref{sec:SGE} for details.
\Ticket{1984}

\item Improved logging in more cases when Condor daemons run out of memory.
\Ticket{2559}

\item Improved verbose logging when \Dflag{MACHINE} is enabled in
\MacroNI{NEGOTIATOR\_DEBUG}.  Previously, it logged whether each
candidate machine matched or did not match with each job.  Now, it
additionally logs whether the match was subsequently rejected for
other reasons, such as insufficient priority, rank, or fair share
allocation.

\item Condor will now send email,
if the submit command \Expr{notification = Error} is set and
the job is placed on hold because of a failure, and not by user request.
Previously, email would be sent only if the job was terminated via signal.
\Ticket{1976}

\item A new feature in DAGMan implements a second way to suspend a running DAG.
See section ~\ref{sec:DagSuspend} for details.
\Ticket{2213}

\item The default settings for \Condor{dagman} have changed.
Now, if a node has children, then \Condor{dagman} uses the
\Attr{KeepClaimIdle} attribute, 
introduced in Condor version 7.7.1, to hold onto a claim.
This is a slight optimization, 
as it avoids waiting for a negotiation cycle.
The amount of time is controlled by the
\Macro{DAGMAN\_HOLD\_CLAIM\_TIME} configuration variable.
\Ticket{2673}

\item Improved the output of \Condor{q} \Opt{-dag},
to show the DAG structure as a tree,
with children indented below their parents.
\Ticket{1281}

\item The new FINAL node feature in DAGMan allows the specification
of a special DAG node, 
which is always run at the end of the workflow,
whether the DAG ended successfully or not.
See section~\ref{sec:DAGFinalNode} for details.
\Ticket{1482}

\item Improved the output of \Condor{userprio} to better support hierarchical
groups. 
The first column of the output no longer truncates long user or group names.
User names are shown indented under group names,
when hierarchical groups are in use.
New columns were added to show group quota information.
A new \Opt{-most} option was added to show 
the most useful fields,
since \Opt{-all} now produces a very wide display.
\Ticket{2680}

\end{itemize}

\noindent Configuration Variable and ClassAd Attribute Additions and Changes:

\begin{itemize}

\item The new configuration variable \Macro{JOB\_QUEUE\_LOG} 
specifies an alternative path and file name for the \File{job\_queue.log} file.
The default value is \File{\MacroUNI{SPOOL}/job\_queue.log}.
This alternative location can be
useful if there is a solid state drive which is big enough to hold the
frequently written to \File{job\_queue.log},
but not big enough to hold the whole contents of the spool directory.
\Ticket{2598}

\item The new configuration variable \Macro{DAGMAN\_HOLD\_CLAIM\_TIME}
specifies the amount of time in seconds that the \Condor{schedd} 
will hold a claim idle for a DAGMan job, 
using the \AdAttr{KeepClaimIdle} attribute in the job ClassAd.
\Ticket{2673}

\item The job ClassAd attributes
\AdAttr{ResidentSetSize} and \AdAttr{ProportionalSetSizeKb} now
report the maximum observed memory usage.  
Previously, they reported the most recently observed memory usage.  
This change makes these attributes similar to \AdAttr{ImageSize}, 
which also reports the maximum observed value.  
Previously, \AdAttr{ResidentSetSize} was
usually reported as 0 in the job history for completed jobs, because
when the job was finished, the final observation of memory usage
was 0.
\Ticket{2725}

\item The job ClassAd attribute \Attr{ResidentSetSize} is now rounded 
by default,
using the new default configuration setting
\Expr{SCHEDD\_ROUND\_ATTR\_ResidentSetSize = 25\%}.
\Ticket{2729}

\item The configuration variable \Macro{PROCD\_LOG} now defaults to
\File{\$(LOG)/ProcLog}.  Previously, there was no default value,
so the \Condor{procd} did not log by default.
\Ticket{2775}

\item The meaning of the \Attr{VirtualMemory} attribute of the \Condor{startd} 
has been changed for Linux platforms.
Previously, it was the amount of paging space configured for the system.
So, if a machine with a lot of memory had no paging space, 
the \Attr{VirtualMemory} attribute would report zero.
Now, the \Attr{VirtualMemory} attribute on Linux platforms 
is the sum of paging space and physical memory, 
which more accurately represents the virtual memory size of the machine.
\Ticket{2763}

\item The submit command \SubmitCmd{globus\_xml} is no longer
recognized. Therefore, the following configuration variables are no longer
recognized:
\begin{itemize}
  \item \Expr{GRIDFTP\_SERVER}
\index{GRIDFTP\_SERVER configuration variable no longer exists as of Condor version 7.7.5@\texttt{GRIDFTP\_SERVER} configuration variable no longer exists as of Condor version 7.7.5}
  \item \Expr{GRIDFTP\_SERVER\_WRAPPER}
\index{GRIDFTP\_SERVER\_WRAPPER configuration variable no longer exists as of Condor version 7.7.5@\texttt{GRIDFTP\_SERVER\_WRAPPER} configuration variable no longer exists as of Condor version 7.7.5}
  \item \Expr{GRIDFTP\_URL\_BASE}
\index{GRIDFTP\_URL\_BASE configuration variable no longer exists as of Condor version 7.7.5@\texttt{GRIDFTP\_URL\_BASE} configuration variable no longer exists as of Condor version 7.7.5}
  \item \Expr{GT4\_GAHP}
\index{GT4\_GAHP configuration variable no longer exists as of Condor version 7.7.5@\texttt{GT4\_GAHP} configuration variable no longer exists as of Condor version 7.7.5}
  \item \Expr{GT4\_LOCATION}
\index{GT4\_LOCATION configuration variable no longer exists as of Condor version 7.7.5@\texttt{GT4\_LOCATION} configuration variable no longer exists as of Condor version 7.7.5}
  \item \Expr{GT42\_GAHP}
\index{GT42\_GAHP configuration variable no longer exists as of Condor version 7.7.5@\texttt{GT42\_GAHP} configuration variable no longer exists as of Condor version 7.7.5}
  \item \Expr{GT42\_LOCATION}
\index{GT42\_LOCATION configuration variable no longer exists as of Condor version 7.7.5@\texttt{GT42\_LOCATION} configuration variable no longer exists as of Condor version 7.7.5}
  \item \Expr{GRIDMANAGER\_MAX\_WS\_DESTROYS\_PER\_RESOURCE}
\index{GRIDMANAGER\_MAX\_WS\_DESTROYS\_PER\_RESOURCE configuration variable no longer exists as of Condor version 7.7.5@\texttt{GRIDMANAGER\_MAX\_WS\_DESTROYS\_PER\_RESOURCE} configuration variable no longer exists as of Condor version 7.7.5}
\end{itemize}
\Ticket{2782}

\item The new configuration variable
\Macro{GRIDMANAGER\_PROXY\_REFRESH\_TIME} controls when the
\Condor{gridmanager} forwards a refreshed proxy to the remote GRAM server.
The lifetime remaining on the proxy on the remote server (in seconds) must
fall below this value before the \Condor{gridmanager} will forward a
refreshed proxy. 
The default value is 21600 seconds (6 hours).
Previously, this value was not configurable.
\Ticket{2792}

\item New job ClassAd attributes were added to assist in tracking the time
jobs spend transferring output.  \Attr{JobCurrentStartExecutingDate} is the
time that execution actually begins, and \Attr{JobCurrentStartTransferOutputDate}
is the time that transfer output begins (and execution ends).  In addition,
\Attr{CumulativeTransferTime} is the total amount of time the job spent transferring
data.  This includes input and output.
\Ticket{2783}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug in which \Condor{submit} allowed the specification of
\SubmitCmd{ec2\_secret\_access\_key} and \SubmitCmd{ec2\_access\_key\_id}
to be directories instead of files.
\Condor{submit} now generates an error in these cases.
\Ticket{2619}

\item Communication errors were not always correctly handled when
fetching results of a query when using the \Opt{-stream} option to
\Condor{q}.  This problem was introduced in Condor version 7.7.0.
\Ticket{2601}

\item Fixed Condor's CronTab (Crondor, section~\ref{sec:CronTab})
scheduling of jobs,
as they did not correctly take into account
shifts in time caused by daylight savings time transitions.
\Ticket{2620}

\item Previously, \Condor{ssh\_to\_job} sessions inherited the \Condor{starter}
environment.  Now, this only happens when
\MacroNI{JOB\_INHERITS\_STARTER\_ENVIRONMENT} is \Expr{True}.
\Ticket{2621}

\item On Linux platforms, the memory usage was ignored for job sub-processes
that were created via \Procedure{fork} without calling \Procedure{exec}.
This problem affected \Attr{ImageSize} and \Attr{ResidentSetSize},
but not \Attr{ProportionalSetSize}.

\item Fixed a rare condition that could cause a job to remain in the
running state indefinitely when the job was removed or put on hold
and there was a communication failure between the \Condor{shadow}
and the \Condor{starter}.  
This problem was introduced in Condor version 7.7.2.
\Ticket{2591}

\item Fixed a bug in the \Condor{gridmanager} that could cause crashes
and prevent the attribute \Attr{x509UserProxyEmail} from being set properly for
jobs forwarded via Condor-C.
\Ticket{2655}

\item Fixed the output of \Condor{q} \Opt{-dag},
such that children of a non-existent DAG node would not be mistakenly 
shown as belonging to another instance of \Condor{dagman}.
This can happen, for example, when a \Condor{dagman} process dies while
its children are still running.
\Ticket{2463}

\item Fixed a bug in \Condor{dagman} that caused a DAG to fail if node
job user log files were actually symbolic links.  
This problem was introduced in the Condor 7.7 development series.
\Ticket{2704}

\item Fixed a bug in the collection of Statistics attributes,
introduced in Condor version 7.7.2.
Condor did not count completed scheduler universe jobs in reported statistics.
\Ticket{2731}

\item Fixed a rare bug in which the \Condor{c-gahp} process could get
into an infinite loop on start up,
if more than one \Condor{c-gahp} was running under different users,
and the names of the users only differed in their last character.
\Ticket{2749}

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item Condor's ability to use cgroup-based process tracking,
available since Condor version 7.7.0,
has now been documented in section~\ref{sec:CGroupTracking}.
\Ticket{1831}
\Ticket{2120}

\item Submitter ClassAd attributes are now documented in the unnumbered
appendix on page~\pageref{sec:Submitter-ClassAd-Attributes}.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-7-4}Version 7.7.4}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Condor version 7.7.4 released on December 21, 2011.
This release contains all features and bug fixes from Condor version 7.6.5 
as are currently documented (section~\ref{sec:New-7-6-5}) in this manual. 

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Condor version 7.7.4 has all of the features and fixes of 7.7.3, it 
includes work toward running on a pure IPv6 network.  This is disabled by
default.  There is an severe bug where enabling IPv6 in a multi-computer pool
may cause the \Condor{starter} to crash.  For 
more information on enabling IPv6 support in the 7.7 series of Condor, see \URL{https://condor-wiki.cs.wisc.edu/index.cgi/wiki?p=HowToEnableIpvSix}.
\Ticket{9}

\end{itemize}

\noindent Configuration Variable and ClassAd Attribute Additions and Changes:

\begin{itemize}

\item None.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item None.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item When IPv6 is enabled and you have multiple computers in your pool, the \Condor{starter} may crash.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-7-3}Version 7.7.3}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Condor version 7.7.3 not yet released.
%\item Condor version 7.7.3 released on Month Date, 2011.

\item On Linux and Mac OS X, the Condor binaries now dynamically link with
\File{libcondor\_utils}, 
a shared library that contains all Condor code that is
used by multiple binaries. 
This library is not meant to be linked with user applications.
\Ticket{2132}

\item \emph{Condor now dynamically links with the ClassAds, Globus and VOMS
libraries on Mac OS X.}
A copy of these libraries is included with Condor.
\Ticket{2482}

\end{itemize}


\noindent New Features:

\begin{itemize}

\item In Condor version 7.7.2, multiple Condor installations led to the
possibility for some installations to use the wrong version of the ClassAds 
library.
This should no longer be an issue, 
as the binaries now use \Env{RUNPATH} instead of \Env{RPATH}, 
allowing use of the \Env{LD\_LIBRARY\_PATH} environment variable 
to set where to look for the shared libraries.
\Ticket{2539}

\item The Amazon SOAP interface is no longer present or supported in Condor.
The EC2 REST interface is favored and supported in Condor
using a \SubmitCmd{grid\_resource} of \SubmitCmd{ec2}.
\Ticket{2523}

\item The new \Condor{gather\_info} tool introduced in 
Condor version 7.5.6 has been updated and enhanced.
It collects data about a Condor installation, and, if desired, 
about a specific job. 
This information is useful to Condor developers to help 
debug problems in a pool or with a job.
\Ticket{1664}
\Ticket{2372}

\item The \Condor{userprio} tool supports two new command line options.
The \Opt{-grouporder} flag displays submitter entries 
for accounting groups at top of the list,
 in breadth-first order by group hierarchy.
The \Opt{-grouprollup} flag reports accounting statistics for groups 
as summed at a level within the group hierarchy.
\Ticket{1926}

\item The \Condor{collector} now avoids the performance problems caused
previously when clients initiated communication with the \Condor{collector},
but then delayed sending input.
\Ticket{2506}

\item When using versions of \Prog{glexec} that create a copy of the proxy 
for use by the job, 
Condor now ensures that this copy of the proxy is cleaned up
when the job is done.
\Ticket{2501}

\item The \Condor{startd} now logs a clear message, if it rejects a job
because no valid \Condor{starter} daemons were detected.
\Ticket{2470}

\item The new submit command \SubmitCmd{want\_graceful\_removal}
may be used to specify that a job being removed or put on hold should
be shut down gracefully, rather than being immediately hard-killed.
This allows the job to perform some final actions such as cleaning
up or saving state.  The usual policies governing the Preempting/Vacating
state apply in this case.  

This new submit command replaces a different mechanism that was added 
in Condor version 7.5.2 to achieve some of the same effects.  
The version 7.5.2 mechanism applied to vanilla jobs under Linux;
if the job set \SubmitCmd{remove\_kill\_sig} or \SubmitCmd{kill\_sig},
the hard-kill signal that Condor would normally send to end the job was
replaced with the signal specified by the user.  

With the new submit command, the version 7.5.2 mechanism is no longer used.
The soft-kill signal may still be customized using
\SubmitCmd{kill\_sig}, so a similar effect can be achieved by setting
\Expr{want\_graceful\_removal=True} and setting \SubmitCmd{kill\_sig}
to an alternative signal, if desired.  The new mechanism works on all
platforms and works for all universes in which the job is managed by
the \Condor{startd}; as such the new mechanism is not supported
in the grid, local, or scheduler universes.

In addition, the new submit command \SubmitCmd{job\_max\_vacate\_time}
replaces the \SubmitCmd{kill\_sig\_timeout} command.
\SubmitCmd{job\_max\_vacate\_time}
adjusts the time given to an evicted job for gracefully shutting down.
\Ticket{2536}

\item The \Condor{master} now logs a more informative error message
when it fails to start a daemon.
\Ticket{2580}

\item The \Condor{schedd} daemon now logs a more informative error message
when it rejects job ClassAd updates from the \Condor{shadow} due to
authorization problems.
\Ticket{2581}

\end{itemize}

\noindent Configuration Variable and ClassAd Attribute Additions and Changes:

\begin{itemize}

\item The new configuration variable \Macro{MachineMaxVacateTime} is
now used to express the maximum time in seconds that the machine is
willing to wait for a job to gracefully shut down.  
The default is 600 seconds (10 minutes).  
The boolean \MacroNI{KILL} expression was
previously used to terminate the graceful shutdown of jobs.  
It should normally be set to \Expr{False} now.  If desired, it may be
used to abort the graceful shutdown of the job earlier than
\MacroNI{MachineMaxVacateTime}.
\Ticket{2536}

\item The new configuration variable \Macro{NEGOTIATOR\_SLOT\_CONSTRAINT} 
defines an expression which constrains which ClassAds are fetched
by the \Condor{negotiator} from the \Condor{collector}
for the negotiation cycle. 
\Ticket{2277}

\item The new configuration variable 
\Macro{NEGOTIATOR\_SLOT\_POOLSIZE\_CONSTRAINT} 
replaces \Macro{GROUP\_DYNAMIC\_MACH\_CONSTRAINT}.
\MacroNI{GROUP\_DYNAMIC\_MACH\_CONSTRAINT} may still be used,
but a warning is written to the log,
identifying that the configuration needs to be updated to use the new name.
The pool size resulting from applying this constraint is used
to determine quotas for both dynamic quotas in hierarchical groups,
and when there are no groups.
\Ticket{2277}

\item The configuration variable \Macro{NEGOTIATOR\_STARTD\_CONSTRAINT\_REMOVE} 
was introduced in Condor version 7.7.1.
It has now been removed, as its functionality 
was made obsolete by \MacroNI{NEGOTIATOR\_SLOT\_CONSTRAINT}.
\Ticket{2277}

\item The configuration variables \Macro{IGNORE\_NFS\_LOCK\_ERRORS}
and \Macro{BIND\_ALL\_INTERFACES} no longer support the undocumented use of
'Y' or 'y' to mean \Expr{True}.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug from Condor version 7.7.1
that caused submit description file commands using a substitution macro,
\$\$(),
to not work correctly when a \Condor{shadow} daemon is recycled,
as it is when the configuration variable \Macro{SHADOW\_WORKLIFE}
is set to a non-zero value.
\Ticket{2552}

\item When the \Condor{procd}'s named command pipe is removed, 
or when the inode of the pipe has been changed while the daemon is running, 
the \Condor{procd} will now exit.
Its previous behavior had the \Condor{procd} continue to execute 
in a useless mode of operation, unable to receive any communication.
\Ticket{2500}

\item For Mac OS X platforms, 
improper detection of a non existent process led to lines such as
\begin{verbatim}
ProcAPI sanity failure on pid 1317, age = -1901476270
\end{verbatim}
appearing in the \Condor{master} daemon log.
This should no longer be the case.
\Ticket{2594}

\item Fixed a bug introduced with hierarchical group quotas that
failed to correctly initialize table entries.
The fix adds logic to the accounting mechanism in the
\Condor{negotiator} daemon,
such that initialization occurs correctly 
when starting up and upon reconfiguration.
\Ticket{2509}

\item When \Condor{advertise} is used with the \Opt{-tcp} option, this
used to cause the following log message to appear in the \Condor{collector}
log:
\begin{verbatim}
DaemonCore: Can't receive command request from IP (perhaps a timeout?)
\end{verbatim}
\Ticket{2483}

\item Fixed a bug introduced in Condor version 7.7.0,
in which the setting of \MacroNI{NETWORK\_INTERFACE} did not have any effect.
\Ticket{2513}

\item \Prog{glexec} now also works when Condor is running as root.
\Ticket{2503}

\item The \Condor{master} daemon now successfully advertises itself in 
a Personal Condor installation,
when the \Condor{collector} is configured to use port 0
and to operate through a shared port.
\Ticket{2555}

\item Since Condor version 7.7.1, 
the configuration variable \Macro{WANT\_HOLD} did not work,
unless \Macro{WANT\_HOLD\_SUBCODE} was set to a non-zero value.
\Ticket{2565}

\item Since Condor version 7.7.2, there was a rare condition that could cause
a job to be removed from the queue,
if the job was put on hold while it was running.
In such cases, there was also a spurious
unsuspend event logged in the job's user log.
\Ticket{2577}

\item Fixed a bug introduced in Condor version 7.7.2 by the change 
of \Attr{OpSys} to \AdStr{WINDOWS}.
Submit description files that used old syntax for the 
\SubmitCmd{environment} command
were using Unix syntax rather than Windows syntax.
\Ticket{2607}

\item Fixed the linking of Kerberos libraries on RHEL 3. 
The bug could cause
the Condor binaries to fail on some systems with the error:
\begin{verbatim}
relocation error: /usr/kerberos/lib/libgssapi_krb5.so.2: 
undefined symbol: krb5int_enc_arcfour
\end{verbatim}
\Ticket{2627}

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-7-2}Version 7.7.2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Condor version 7.7.2 released on October 11, 2011.
This release contains all features and bug fixes from Condor version 7.6.4
as are currently documented (section~\ref{sec:New-7-6-4}) in this manual. 

\item
\emph{Condor now dynamically links with the ClassAds, Globus and VOMS libraries on
linux.}
A copy of these libraries is included with Condor, under
\File{lib/condor/} in the tarball releases and under
\File{/usr/lib/condor/} or \File{/usr/lib64/condor/} in the native package
releases.
\Ticket{2389}
\Ticket{2390}

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Condor's standard universe now supports reading from and writing to
files that are larger than 2 GBytes,
when the standard universe application and
the \Condor{shadow} daemon are both 64-bit executables.
\Ticket{2337}

\item There is command line support to both suspend and continue jobs. 
The new tools \Condor{suspend} and \Condor{continue} will 
suspend and continue running jobs.
\Ticket{2368}

\item The EC2 GAHP now supports X.509 for connecting to and authenticating
with EC2 services.  See section~\ref{sec:Amazon-submit} for details
on using the X.509 protocol.
\Ticket{2084}

\item Previously, the dedicated scheduler attempted to change the
\Attr{Scheduler} attribute on all parallel job processes in a durable fashion,
resulting in an \Procedure{fsync} for each process.
This has been changed to be not durable, 
thereby improving the scalability by reducing the 
number of \Procedure{fsync} calls without impacting correctness. 
\Ticket{2367}

\item In PrivSep mode, when an error is encountered when trying to
switch to the user account chosen for running the job, 
the error message has been improved to make debugging easier.  
Now, the error message distinguishes between safety check failures 
for the UID, tracking group ID, primary group ID, and supplementary group IDs.
\Ticket{2364}

\item The name of the user used to execute the job is now logged in
the \Condor{starter} log, except when using \Prog{glexec}.
\Ticket{2268}

\item \Condor{dagman} now defaults to writing a partial DAG file
for a Rescue DAG,
as opposed to a full DAG file.
The Rescue DAG file is parsed in combination with the original DAG file, 
meaning that any
changes to the original DAG input file take effect when running a Rescue DAG.
\Ticket{2165}

\item The behavior of DAGMan is changed, such that, by default, 
POST scripts will be run regardless of the return value from 
the PRE script of the same node as described in section~\ref{dagman:SCRIPT}.  
The previous behavior of not running the POST script can be restored by
either adding the \Opt{-DontAlwaysRunPost} option to the \Condor{submit\_dag}
command line, 
or by setting the new configuration variable
\Macro{DAGMAN\_ALWAYS\_RUN\_POST} to \Expr{False}, 
as defined at~\ref{param:DAGmanAlwaysRunPost}.
\Ticket{2057}

\item DAGMan will now copy PRIORITY values from the DAG input file to 
the \Attr{JobPrio} attribute in the job ClassAd.  
Furthermore, the PRIORITY values are propagated to child nodes and SUBDAGs, 
so that child nodes always have priority at least that
of the maximum of the priorities of its parents.  
This has been a cause of confusion for DAGMan users.
\Ticket{2167}

% moved to 7.7.2 
% gittrac #659 
%\item Filip Krikava supplied a patch that limits the number of 
%file descriptors that DAGMan has open at a time.
%The reason for creating this capability is that
%DAGMan tends to fail on wide DAGs, where many jobs are independent,
%rather than being linear, where jobs have many dependencies.

\item A matchmaking optimization has significantly improved the speed 
of matching,
when there are machines with many slots.
\Ticket{2403}

\item When the \Condor{schedd} is starting up and it encounters corruption
in its job transaction log, the error message in the log file now reports
the offset within the file at which the error occurred.
\Ticket{2450}

\end{itemize}

\noindent Configuration Variable and ClassAd Attribute Additions and Changes:

\begin{itemize}

\item The new job ClassAd attribute \Attr{PreserveRelativeExecutable}, 
when \Expr{True} prevents the \Condor{starter} from 
prepending \Attr{Iwd} to the command executable \Attr{Cmd},
when \Attr{Cmd} is a relative path name and \Attr{TransferExecutable} 
is \Expr{False}.
\Ticket{2460}

\item Attributes have been added to all daemons to publish statistics 
about the the number of timers, signals, socket, and pipe messages 
that have been handled, as well as the amount of time spent handling them.	Statistics attributes for DaemonCore
have names that begin with \Expr{DC} or \Expr{RecentDC}.
\Ticket{2354}

\item The default value of \Attr{OpSys} on Windows machines has been changed
to \AdStr{WINDOWS}, and a new attribute \Attr{OpSysVer} has been added 
that contains the version number of the operating system.  
This behavior is controlled by a new configuration variable
\Macro{ENABLE\_VERSIONED\_OPSYS} which defaults to \Expr{False} on Windows 
and to \Expr{True} on other platforms.  
The new machine ClassAd attribute \Attr{OpSys\_And\_Ver} will always contain 
the versioned operating system.  
Note that this change could cause problems with mixed pools,
because Condor version 7.7.2 \Condor{submit} may add \Expr{OpSys="WINDOWS"}, 
but machines running Condor versions prior to 7.7.2 will be publishing 
a versioned \Attr{OpSys} value,
unless there is an override in the configuration.
\Ticket{2366}

\item Configuration variable \Macro{COLLECTOR\_ADDRESS\_FILE} is now set 
in the example configuration,
similar to \MacroNI{MASTER\_ADDRESS\_FILE}.
This configuration variable is required when \Macro{COLLECTOR\_HOST} 
has the port set to 0, which means to select any available port.
In other environments, it should have no visible impact.
\Ticket{2375}

% gittrac #2197
\item Attributes have been added to the \Condor{schedd} 
to publish aggregate statistics
about jobs that are running and have completed, as well as counts of various
failures. 
% Next sentence is made into a comment, as there is no documentation
%     to look at.
% See section ??? for details.
\Ticket{2197}

\item The new configuration variable \Macro{DAGMAN\_WRITE\_PARTIAL\_RESCUE}
enables the new feature of writing a partial DAG file, instead of a full
DAG input file, as a Rescue DAG.  
See section~\ref{param:DAGManWritePartialRescue} for a definition.
Also, the configuration variable
\Macro{DAGMAN\_OLD\_RESCUE} no longer exists,
as it is incompatible with the implementation of partial Rescue DAGs.
\Ticket{2165}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug introduced in Condor version 7.7.1, 
in the standard universe,
where the \Syscall{getdirentries} call failed during remote I/O situations.
\Ticket{2467}

\item Fixed a bug in the \Condor{startd} that was preventing dynamic slots
from being properly instantiated from partitionable slots.
\Ticket{2507}

\item Fixed a bug introduced in Condor version 7.7.0, 
in which the \Condor{startd} may erroneously report 
\Expr{Can't find hostname of client machine.}
In cases where Condor was unable to identify the host name, 
the \Attr{ClientMachine}
attribute in the machine ClassAd would have gone unset.
\Ticket{2382}

\item Fixed a bug existing since April 2001,
in which on start up of the \Condor{schedd}, with parallel universe jobs, 
the job queue sanity checking code would change the \Attr{Scheduler}
attribute on jobs,
only to have the attribute changed later by the dedicated scheduler.
\Ticket{2367}

\item Machine ClassAds with the \Attr{Offline} attribute set to \Expr{True},
and  with neither \Attr{MyType} nor \Attr{TargetType} 
attributes defined caused
the \Condor{collector} to fail to start when it was next restarted.
\Ticket{2417}

\item Fixed a file descriptor leak in the EC2 GAHP,
which would cause grid-type ec2 jobs to become held. 
The \Attr{HoldReason} for most such jobs would be 
\Expr{Unable to read from accesskey file.}
\Ticket{2447}

\item Fixed a bug that could cause a job's standard output and error to
be written to the wrong location when \SubmitCmd{should\_transfer\_files} was
set to \Expr{IF\_NEEDED},
and the job runs on the machine where file transfer is not needed.
If the standard output or error file names contained any path information,
the output would be written to \File{\_condor\_stdout} or
\File{\_condor\_stderr} in the job's initial working directory.
\Ticket{1811}

\item Fixed a bug introduced in Condor version 7.7.1
that could cause the \Condor{schedd} daemon to crash after
failing to expand a \verb@$$@ macro in the job ClassAd.
\Ticket{2491}

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item In Condor version 7.7.2, 
the Condor daemons on Linux platforms rely on shared libraries.  
A bug in Condor version 7.7.1 and all previous versions of Condor
prevents a 7.7.1 \Condor{master} from starting 7.7.2 or later daemons.
This also means that a 7.7.1 \Condor{master} cannot upgrade itself to 
version 7.7.2.  
If a 7.7.1 \Condor{master} binary is replaced with 
a 7.7.2 \Condor{master} binary, 
Condor will shut off, and need to be restarted by hand.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-7-1}Version 7.7.1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

%\item Condor version 7.7.1 not yet released.
\item Condor version 7.7.1 released on September 12, 2011.
This developer release contains all bug fixes from Condor version 7.6.3.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item
\emph{Condor now dynamically links with the OpenSSL and Kerberos security
libraries, and Condor will use the operating system's version of these
libraries,  when they are available.} 
The tarball release of Condor on Linux platforms includes 
a copy of these libraries.  
If the operating system's version is incompatible with Condor, 
Condor will use its own copy instead.
Condor's copy of these libraries is located under \File{lib/condor/}.
To prevent Condor from considering using them, delete these libraries.
\Ticket{1874}

\item 
The ClassAd language now has an \Procedure{unparse} function.  
It converts an expression into a string, 
which is handy with the new \Procedure{eval} function.
\Ticket{1613}

\item
The new job ClassAd attribute \Attr{KeepClaimIdle} is defined with an integer
number of seconds in the job submit description file, as the example:
\begin{verbatim}
  +KeepClaimIdle = 300
\end{verbatim}
If set, then when the job exits, 
if there are no other jobs immediately ready to run for this user, 
the \Condor{schedd} daemon,
instead of relinquishing the claim back to the \Condor{negotiator}, 
will keep the claim for the specified number of seconds.  
This is useful if another job will be arriving soon, 
which can happen with linear DAGs.  
The \Condor{startd} slot
will go to the Claimed Idle state for at least that many seconds until
either a new job arrives or the timeout occurs.
See page~\pageref{sec:Job-ClassAd-Attributes},
the unnumbered Appendix A for a complete definition of this
job ClassAd attribute.
\Ticket{2094}

% gittrac #2122
\item The new \Arg{PRE\_SKIP} key word in DAGMan changes the
behavior of DAG node execution such that the node's job and POST script
may be skipped based on the exit value of the PRE script.
See section ~\ref{dagman:SCRIPT} for details.
\Ticket{2122}

% uncomment item, if it appears in 7.7.1
% gittrac #659 
%\item Filip Krikava supplied a patch that limits the number of 
%file descriptors that DAGMan has open at a time.
%The reason for creating this capability is that
%DAGMan tends to fail on wide DAGs, where many jobs are independent,
%rather than being linear, where jobs have many dependencies.

\end{itemize}

\noindent Configuration Variable and ClassAd Attribute Additions and Changes:

\begin{itemize}

\item The new configuration variable 
\Macro{NEGOTIATOR\_STARTD\_CONSTRAINT\_REMOVE} defaults to \Expr{False}.
When \Expr{True}, any ClassAds not satisfying the expression 
in \MacroNI{GROUP\_DYNAMIC\_MACH\_CONSTRAINT} are removed from the
list of \Condor{startd} ClassAds considered for negotiation.
\Ticket{2232}

\item The new configuration variable
\Macro{NEGOTIATOR\_UPDATE\_AFTER\_CYCLE} defaults to \Expr{False}.
When \Expr{True}, it forces the \Condor{negotiator} daemon
to update the negotiator ClassAd in the \Condor{collector} daemon
at the end of every negotiation cycle.  
This is handy for monitoring and debugging activities.
\Ticket{2373}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Expressions for periodic policies such as 
\MacroNI{PERIODIC\_HOLD} and \MacroNI{PERIODIC\_RELEASE} 
could inadvertently cause a claim to be released,
 if the \Condor{shadow} exited before waiting for final update from the 
\Condor{starter}. 
\Ticket{2329}

\item \Condor{submit} previously could incorrectly detect references
in the requirements expression to special attributes such as
\Attr{Memory} when the name of the attribute happened to appear in a
string literal or as part of the name of some other attribute.  
The detection of references to various special attributes influences the
automatic requirements which are appended to the job requirements.
\Ticket{2350}

\item In rare cases, CCB requests could cause the server to hang for
20 seconds while waiting for all of the request to arrive.
\Ticket{2360}

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-7-0}Version 7.7.0}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Condor version 7.7.0 released on July 29, 2011.
This developer release contains all bug fixes from Condor version 7.6.2.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item A full port of Condor is available for RedHat Enterprise Linux 6
on the x86\_64 processor.
A full port includes support for the standard universe.

\item The matchmaking attributes \Attr{SubmitterUserResourcesInUse}
and \Attr{RemoteUserResourcesInUse} are now biased by slot weights.

% gittrac #1971
\item \Condor{submit} now accepts the new command line option \Opt{-addr},
naming the IP address of the \Condor{schedd} to submit to.

\item The \Condor{vm\_gahp} now is dynamically linked to libvirt.  
We believe this makes it more portable.

\item Programs \Condor{reconfig\_schedd} and \Condor{master\_off}
are no longer part of the distribution.
These programs were replaced many years ago by the more general
\Condor{reconfig} and \Condor{off} commands.

\item On Windows platforms, improved the ability of the \Condor{starter}
and \Condor{shadow} daemons to clean up the execute directory,
if jobs have changed the ACLs or permissions on files they have created.

\item \Condor{submit} now sets a default value for job ClassAd attribute
\Attr{RequestMemory}.

\item The submission performance of cream grid jobs has been substantially
improved by batching submit requests.

\item \Condor{q} \Opt{-better} now has cleaner output, and informs
the user when negotiation has not yet occurred.

\item Implemented many improvements to the Condor \Prog{init} scripts.

\item Deltacloud support has been updated to deltacloud version 0.8.

% gittrac #1960
\item As of Condor version 7.6.0,
vm universe submit description files no longer support
automatic creation of cdrom images from text input file.
Users must now explicitly create ISO images and transfer them
with the job.

\item \Condor{q} now supports the new option \Opt{-stream-results}.
  When this option is specified, \Condor{q} displays results as they
  are fetched from the job queue, rather than buffering up the query
  results before displaying anything.

% gittrac #1871 
% gittrac #2295
\item The new submit description file command \SubmitCmd{stack\_size} 
  applies to Linux jobs that are not running in the standard universe. 
  It sets the allocation of stack space to be other than the default
  value, which is unlimited.
  It also advertises the job ClassAd attribute \AdAttr{StackSize}.

% gittrac #1550
\item The new ClassAd function \Code{stringListsIntersect} evaluates to 
  \Expr{True} if two strings of delimited elements have any matching elements,
  and it evaluates to \Expr{False} otherwise.

% gittrac #1821
\item The grid universe now supports the \SubmitCmd{ec2} resource type,
  which uses the EC2 Query (REST) API to start virtual machines on cloud
  resources.

% gittrac #2090 
\item The behavior of DAGMan has changed, 
such that if multiple definitions of a VARS macroname 
for a specific node within a DAG input exist,
a warning is written to the log, of the format
\begin{verbatim}
Warning: VAR <macroname> is already defined in job <JobName>
Discovered at file "<DAG input file name>", line <line number>
\end{verbatim}
See section ~\ref{dagman:VARS} for details.

% gittrac #2297
\item The version number for ClassAds now matches the Condor version number. 

% gittrac #2259
\item When \Prog{glexec} fails to execute a job,
diagnostic error messages produced by \Prog{glexec} used to be discarded.
These error messages are now displayed in the log of the \Condor{starter} 
and in the job's hold reason. 

% gittrac #2185
\item New submit description file commands
\SubmitCmd{periodic\_hold\_reason}, \SubmitCmd{periodic\_hold\_subcode},
\SubmitCmd{on\_exit\_hold\_reason}, and \SubmitCmd{on\_exit\_hold\_subcode}
permit the job to set a hold reason string and subcode number.
Similarly, the system job policy can specify the reason and subcode 
using \Macro{SYSTEM\_PERIODIC\_HOLD\_REASON} and 
\Macro{SYSTEM\_PERIODIC\_HOLD\_SUBCODE}.
In addition, the \Condor{hold} command now accepts a \Opt{-subcode} option,
which is used to set the job attribute \Attr{HoldReasonSubCode}. 

\item If the \Condor{shadow} cannot write to the user log, 
the job is now put on hold.

\end{itemize}


\noindent Configuration Variable and ClassAd Attribute Additions and Changes:

\begin{itemize}

\item The new configuration variable \Macro{NEGOTIATOR\_UPDATE\_AFTER\_CYCLE}
defaults to \Expr{False}.
If set to \Expr{True}, it will force the \Condor{negotiator} daemon
to publish an update ClassAd to the \Condor{collector} at the end of 
every negotiation cycle. 
This is useful if monitoring cycle-based statistics.

\item The configuration variables for security 
\Macro{DENY\_CLIENT} and \Macro{HOSTDENY\_CLIENT}
now also look for the prefixes \Expr{TOOL} and \Expr{SUBMIT}.
 
% gittrac #1249
\item \Macro{CONDOR\_VIEW\_HOST} is now a comma and/or white space separated
list of hosts, in order to support more than one CondorView host.

\item For a job with an X.509 proxy credential, the new job ClassAd
attribute \AdAttr{X509UserProxyEmail} is the email address extracted
from the proxy.

% gittrac 2067
\item On Linux execute machines with kernel version more recent than 2.6.27,
the proportional set size (PSS) in Kbytes summed across all
processes in the job is now reported in the attribute
\AdAttr{ProportionalSetSizeKb}.  If the execute machine does not
support monitoring of PSS or PSS has not yet been measured, this
attribute will be undefined.  PSS differs from \AdAttr{ImageSize} in
how memory shared between processes is accounted.  The PSS for one
process is the sum of that process' memory pages divided by the
number of processes sharing each of the pages.  \AdAttr{ImageSize} is
the same, except there is no division by the number of processes
sharing the pages.

% gittrac #1755
\item The new configuration variable \Macro{DAGMAN\_USE\_STRICT} 
turns warnings into errors, as defined in section~\ref{param:DAGManUseStrict}.

% gittrac #2006
\item The \Condor{schedd} now publishes performance-related statistics.
  Page~\pageref{sec:Scheduler-ClassAd-Attributes} in Appendix A contains
  definitions for these new attributes:
  \begin{itemize}
    \item \Attr{DetectedMemory}
    \item \Attr{DetectedCpus}
    \item \Attr{UpdateInterval}
    \item \Attr{WindowedStatWidth}
    \item \Attr{ExitCode<N>}
    \item \Attr{ExitCodeCumulative<N>}
    \item \Attr{JobsSubmitted}
    \item \Attr{JobsSubmittedCumulative}
    \item \Attr{JobsStarted}
    \item \Attr{JobsStartedCumulative}
    \item \Attr{JobsCompleted}
    \item \Attr{JobsCompletedCumulative}
    \item \Attr{JobsExited}
    \item \Attr{JobsExitedCumulative}
    \item \Attr{ShadowExceptions}
    \item \Attr{ShadowExceptionsCumulative}
    \item \Attr{JobSubmissionRate}
    \item \Attr{JobStartRate}
    \item \Attr{JobCompletionRate}
    \item \Attr{MeanTimeToStart}
    \item \Attr{MeanTimeToStartCumulative}
    \item \Attr{MeanRunningTime}
    \item \Attr{MeanRunningTimeCumulative}
    \item \Attr{SumTimeToStartCumulative}
    \item \Attr{SumRunningTimeCumulative}
  \end{itemize}

% gittrac #1930
\item For Windows platforms, the \Condor{startd} now publishes the 
ClassAd attribute \Attr{DotNetVersions},
containing a comma separated list of installed .NET versions.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug in which the \Condor{startd} daemon can get stuck in a
loop trying to execute an invalid, 
that is non-existent, Daemon ClassAd Hook job.

\item Fixed bug that would cause the \Condor{startd} daemon to incorrectly
report Benchmarking activity instead of Idle activity,
when there is a problem launching the benchmarking programs.

\item On Windows only, fixed a rare bug that could cause
a sporadic access violation when a Condor daemon spawned another process.

\item Fixed a bug introduced in Condor version 7.5.5,
which caused the \Condor{schedd} to die managing parallel jobs.

% commented out, as this bug fix is listed in the 7.6.1 version history.
% \item Fixed bug present throughout ClassAds,
% where expressions expecting a floating point value returned an error,
% if they got a boolean value.  This is common in \MacroNI{RANK} expressions.

\item The \Condor{startd} daemon now looks up the \Condor{kbdd} daemon address
on every update.  
This fixed problems if the \Condor{kbdd} daemon is restarted 
during the \Condor{startd} lifespan.

\item Fixed bug in \Condor{hold} that happened if the hold
reason contained a double quote character.

\item Fixed a bug introduced in Condor version 7.5.6 that
caused any Daemon ClassAd hook job with non-empty value for
\MacroNI{STARTD\_CRON\_<JobName>\_ARGS},
\MacroNI{SCHEDD\_CRON\_<JobName>\_ARGS}
or \MacroNI{BENCHMARKS\_<JobName>\_ARGS} to fail.
Also, the specification of 
\MacroNI{STARTD\_CRON\_<JobName>\_ENV},
\MacroNI{SCHEDD\_CRON\_<JobName>\_ENV},
or \MacroNI{BENCHMARKS\_<JobName>\_ENV} for these jobs was ignored.

\item Fixed bug in the RPM \Prog{init} script. 
A status request would always report Condor as inactive, 
and a shutdown request would not report failure if there was a
timeout shutting down Condor.

\item File transfer plug-ins now have a correctly set environment.

\item Fixed a problem with detecting IBM Java Virtual Machines whose
version strings have embedded newline characters.

\item \Condor{q} \Opt{-analyze} now works with ClassAd built-in functions.

\item Fixed bug in \Condor{q} \Opt{-run}, such that it displays
the host name correctly for local and scheduler universe jobs.

\item Standalone checkpointing now works with compressed checkpoints again.
This had been broken in Condor version 7.5.4.

%gittrac 1962
\item On Windows, \Prog{net stop condor} would sometimes cause the
\Condor{master} daemon to crash.  This is now fixed.

% gittrac #1928
\item \AdAttr{JobUniverse} was effectively a required attribute for
  jobs created via the Fetch Work hook,
  due to the need to set the \MacroNI{IS\_VALID\_CHECKPOINT\_PLATFORM}
  expression, such that it would not evaluate to \Expr{Undefined}.
  Now the default \MacroNI{IS\_VALID\_CHECKPOINT\_PLATFORM} expression
  evaluates to \Expr{True} when \AdAttr{JobUniverse} is not defined.

% gittrac #1943
\item When there are multiple cpus but only one slot, the slot name no
longer begins with \Expr{slot1@}.

% gittrac #1805 
\item The tool \Condor{advertise} seemed to be trying too hard to resolve
host names. This was fixed to only do the minimally necessary 
number of look ups.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}


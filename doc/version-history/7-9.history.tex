%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\label{sec:History-7-9}Development Release Series 7.9}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This is the development release series of Condor.
The details of each version are described below.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-9-1}Version 7.9.1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Condor version 7.9.1 not yet released.
%\item Condor version 7.9.1 released on Month Date, 2012.

\item Condor no longer looks for its main configuration file in the
location \File{\MacroUNI{GLOBUS\_LOCATION}/etc/condor\_config}.
\Ticket{2830}

\end{itemize}


\noindent New Features:

\begin{itemize}

\item \Condor{job\_router} can now submit the routed copy of jobs to a
different \Condor{schedd} than the one that serves as the source of
jobs to be routed.  The spool directories of the two
\Condor{schedds} must still be directly accessible to
\Condor{job\_router}.  This feature is enabled by using the new
optional configuration settings:

\begin{itemize}
\item \Macro{JOB\_ROUTER\_SCHEDD1\_SPOOL}
\item \Macro{JOB\_ROUTER\_SCHEDD2\_SPOOL}
\item \Macro{JOB\_ROUTER\_SCHEDD1\_NAME}
\item \Macro{JOB\_ROUTER\_SCHEDD2\_NAME}
\item \Macro{JOB\_ROUTER\_SCHEDD1\_POOL}
\item \Macro{JOB\_ROUTER\_SCHEDD2\_POOL}
\end{itemize}
\Ticket{3030}

\item \Condor{defrag} now has a policy option to cancel draining
of a machine that is in draining mode.  This can be used to effect
partial draining of machines.
\Ticket{2993}

\end{itemize}

\noindent Configuration Variable and ClassAd Attribute Additions and Changes:

\begin{itemize}

\item Added the attribute \Attr{DAGManNodesMask} to control the verboseness of
the log referred to by \Attr{DAGManNodesLog}.

\item The new configuration variable
\Macro{QUEUE\_SUPER\_USER\_MAY\_IMPERSONATE} specifies a regular
expression that matches the user names that
the queue super user may impersonate when managing jobs.  When not
set, the default behavior is to allow impersonation of any user who
has had a job in the queue during the life of the \Condor{schedd}.  For
proper functioning of the \Condor{shadow}, the \Condor{gridmanager}, and
the \Condor{job\_router}, this expression, if set, must match the owner
names of all jobs that these daemons will manage.
\Ticket{3030}

\label{JobRouterSchedd1Spool}
\item[\Macro{JOB\_ROUTER\_SCHEDD1\_SPOOL}]
  The path to the spool directory for the \Condor{schedd} serving as the
  source of jobs for routing.  If not specified, this defaults to
  \Macro{SPOOL}.  If specified, this parameter must point to the spool
  directory of the \Condor{schedd} identified by \Macro{JOB\_ROUTER\_SCHEDD1\_NAME}.

\label{JobRouterSchedd2Spool}
\item[\Macro{JOB\_ROUTER\_SCHEDD2\_SPOOL}]
  The path to the spool directory for the \Condor{schedd} to which the
  routed copy of the jobs are submitted.  If not specified, this defaults to
  \Macro{SPOOL}.  If specified, this parameter must point to the spool
  directory of the \Condor{schedd} identified by \Macro{JOB\_ROUTER\_SCHEDD2\_NAME}.

\label{JobRouterSchedd1Name}
\item[\Macro{JOB\_ROUTER\_SCHEDD1\_NAME}]
  The advertised daemon name of the \Condor{schedd} serving as the
  source of jobs for routing.  If not specified, this defaults to the
  local \Condor{schedd}.  If specified, this parameter must name the
  same \Condor{schedd} whose spool is configured in
  \Macro{JOB\_ROUTER\_SCHEDD1\_SPOOL}.  If the named \Condor{schedd} is
  not advertised in the local pool, \Macro{JOB\_ROUTER\_SCHEDD1\_POOL}
  will also need to be set.

\label{JobRouterSchedd2Name}
\item[\Macro{JOB\_ROUTER\_SCHEDD2\_NAME}]
  The advertised daemon name of the \Condor{schedd} to which the
  routed copy of the jobs are submitted.  If not specified, this defaults to
  the local \Condor{schedd}.  If specified, this parameter must name the
  same \Condor{schedd} whose spool is configured in
  \Macro{JOB\_ROUTER\_SCHEDD2\_SPOOL}.  If the named \Condor{schedd} is
  not advertised in the local pool, \Macro{JOB\_ROUTER\_SCHEDD2\_POOL}
  will also need to be set.

\label{JobRouterSchedd1Pool}
\item[\Macro{JOB\_ROUTER\_SCHEDD1\_POOL}]
  The Condor pool (collector address) of the \Condor{schedd} serving as the
  source of jobs for routing.  If not specified, this defaults to the
  local pool.

\label{JobRouterSchedd2Pool}
\item[\Macro{JOB\_ROUTER\_SCHEDD2\_POOL}]
  The Condor pool (collector address) of the \Condor{schedd} to which
  the routed copy of the jobs are submitted.  If not specified, this
  defaults to the local pool.

\label{JobRouterSchedd2Pool}
\item[\Macro{DEFRAG\_WHOLE\_MACHINE\_EXPR}]
  This new configuration value is an expression that specifies
  which draining machines should have draining be canceled.  This defaults
  to \Macro{DEFRAG\_WHOLE\_MACHINE\_EXPR}.  This could be used to drain
  partial rather than whole machines.
\Ticket{2993}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item The ClassAd functions \Procedure{splitUserName} and \Procedure{splitSlotName}
leaked a small amount of memory every time they were evaluated.  This bug was
introduced when these functions were added in 7.7.6.
\Ticket{3082}

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-9-0}Version 7.9.0}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Condor version 7.9.0 not yet released.
%\item Condor version 7.9.0 released on Month Date, 2012.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Machine slots can now be configured to identify and
divide customized local resources.
Jobs may then request these resources.
See section~\ref{sec:Configuring-SMP} for details.
\Ticket{2905}

\item Condor now supports and implements the caching of ClassAds 
to reduce memory footprints. Caching may be disabled by setting
the new configuration variable \Macro{ENABLE\_CLASSAD\_CACHING}
to \Expr{False}.
Third party use of the ClassAd library does not enable the
caching of ClassAds by default; 
Condor does enable the caching of ClassAds by default.
\Ticket{2541}
\Ticket{3127}

\item \Condor{status} now returns the \Condor{schedd} ClassAd directly 
from the \Condor{schedd} daemon,
if both options \Opt{-direct} and \Opt{-schedd} are given on the command line.
\Ticket{2492}

\item The new \Opt{-status} and \Opt{-echo} command line options to 
\Condor{wait} command cause it to show job start and terminate information,
and to print events to \Code{stdout}.
\Ticket{2926}

\item Added a \Expr{DEBUG} logging level output flag \Dflag{CATEGORY},
which causes Condor to include the logging level
flags in effect for each line of logged output.
\Ticket{2712}

\item \Condor{status} and \Condor{q} each have a new \Opt{-autoformat} option
to make some output format specifications easier than the existing
\Opt{-format} option.
See the \Condor{status} manual page located on page~\pageref{man-condor-status}
and the \Condor{q} manual page located on page~\pageref{man-condor-q} 
for details.
\Ticket{2941}

\item Enhanced the ClassAd log system to report the log line number 
on parse failures, 
and improved the ability to detect parse failures closer to 
the point of corruption.
\Ticket{2934}

\item Added an \Opt{-evaluate} option to \Condor{config\_val}, which causes the configured value queried from
a given daemon to be evaluated with respect to that daemon's ClassAd.
\Ticket{856}

\item Added code to \Condor{dagman},
such that a \Expr{VARS} assignment in a top-level DAG is applied to splices.
\Ticket{1780}

\item Condor now uses libraries from Globus 5.2.1.
\Ticket{2838}

\item When authenticating Condor daemons with GSI and
configuration variable \MacroNI{GSI\_DAEMON\_NAME} is undefined, 
Condor checks that the server name in the certificate matches the 
host name that the client is connecting to. 
When \MacroNI{GSI\_DAEMON\_NAME} is defined,
the old behavior is preserved: only certificates matching
\MacroNI{GSI\_DAEMON\_NAME} pass the authentication step, 
and no host name check is performed.  
The behavior of the host name check
may be further controlled with the new configuration variables
\MacroNI{GSI\_SKIP\_HOST\_CHECK} and
\MacroNI{GSI\_SKIP\_HOST\_CHECK\_CERT\_REGEX}.
\Ticket{1605}

\item Added new capability to \Condor{submit} to allow recursive macros in
submit description files. 
This facility allows one to update variables recursively. 
Before this new capability was added,
recursive definition would send \Condor{submit} into an
infinite loop of expanding the macro,
such that the expansion would fill up memory.
See section~\ref{macro-in-submit-description-file} for details.
\Ticket{406}

\item A DAGMan limitation and restriction has been removed.  
It is now permitted to define a \SubmitCmd{log} command using a macro,
within a node job's submit description file.
\Ticket{2428}

\item To enforce the dependencies of a DAG,
DAGMan now uses and watches only the default node
user log of the \Condor{dagman} job for events.  
DAGMan requests the \Condor{schedd} and \Condor{shadow} daemons to write each
event to this default log, 
in addition to writing to a log specified by the node job.
\Condor{dagman} writes POST script terminate events only to its default log;
these terminate events are not written to the user log.
This behavior can be turned off by setting the configuration variable
\Macro{DAGMAN\_ALWAYS\_USE\_NODE\_LOG} to \Expr{False}.
For correct behavior,
\MacroNI{DAGMAN\_ALWAYS\_USE\_NODE\_LOG} should be set to \Expr{False}
if \Condor{dagman} version 7.9.0 or later is submitting jobs 
to an older version of
a \Condor{schedd} daemon or of a \Condor{submit} executable.
\Ticket{2807}

\end{itemize}

\noindent Configuration Variable and ClassAd Attribute Additions and Changes:

\begin{itemize}

\item The new configuration variables \Macro{MACHINE\_RESOURCE\_NAMES}
(see section~\ref{param:MachineResourceNames})
and \Macro{MACHINE\_RESOURCE\_<name>}
(see section~\ref{param:MachineResourceResourcename})
identify and specify the use of customized local machine resources.
\Ticket{2905}

\item The new configuration variable \MacroNI{ENABLE\_CLASSAD\_CACHING}
controls whether the new caching feature of ClassAds is used.
The default value is \Expr{True}.
\Ticket{3127}

\item The new configuration variable \Macro{CLASSAD\_LOG\_STRICT\_PARSING}
controls whether ClassAd log files such as the job queue
log are read with strict parse checking on ClassAd expressions.
\Ticket{3069}

\item The default value for configuration variable \Macro{USE\_PROCD}
is now \Expr{True} for the \Condor{master} daemon.  
This means that by
default the \Condor{master} will start a \Condor{procd} daemon to be used 
by it and all other daemons on that machine.
\Ticket{2911}

\item There is a new configuration variable used by the \Condor{starter}.
If \Macro{STARTER\_RLIMIT\_AS} is set to an integer value, 
the \Condor{starter}
will use the \Procedure{setrlimit} system call with the 
\Code{RLIMIT\_AS} parameter to
limit the virtual memory size of each process in the user job.  
The value of this configuration variable is a ClassAd expression, 
evaluated in the context of both the machine and job ClassAds, 
where the machine ClassAd is the \Expr{my} ClassAd, 
and the job ClassAd is the \Expr{target} ClassAd.
\Ticket{1663}

\item New configuration variables were added to to the \Condor{schedd} to
define statistics that count subsets of jobs. 
These variables have the form \Macro{SCHEDD\_COLLECT\_STATS\_BY\_<Name>},
and should be defined by a ClassAd expression that evaluates to a string.
See section~\ref{param:ScheddCollectStatsByName}
for the complete definition.
The optional configuration variable of the form
\Macro{SCHEDD\_EXPIRE\_STATS\_BY\_<Name>} can be used to set an expiration time,
in seconds, for each set of statistics.
\Ticket{2862}

\item The new \SubmitCmd{batch\_queue} submit description file command
and new job ClassAd attribute \Attr{BatchQueue} specify which job
queue to use for grid universe jobs of type
\SubmitCmd{pbs}, \SubmitCmd{lsf}, and \SubmitCmd{sge}.
\Ticket{2996}

\item The new configuration variable \Macro{GSI\_SKIP\_HOST\_CHECK} is
a boolean that controls whether a check is performed during
GSI authentication of a Condor daemon.  
When the default value \Expr{False},
the check is not skipped, so the daemon host name must match the
host name in the daemon's certificate, unless otherwise exempted
by values of \MacroNI{GSI\_DAEMON\_NAME} or
\MacroNI{GSI\_SKIP\_HOST\_CHECK\_CERT\_REGEX}.
When \Expr{True}, this check is skipped, and hosts will not be rejected
due to a mismatch of certificate and host name.
\Ticket{1605}

\item The new configuration variable
\MacroNI{GSI\_SKIP\_HOST\_CHECK\_CERT\_REGEX} may be set to a
regular expression.  GSI certificates of Condor daemons with a
subject name that are matched in full by this regular expression
are not required to have a matching daemon host name and certificate
host name.  The default is an empty regular expression, which will
not match any certificates, even if they have an empty subject name.
\Ticket{1605}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug in which usage of cgroups incorrectly included the page cache 
in the maximum memory usage.
This bug fix is also included in Condor version 7.8.2.
\Ticket{3003}

\item The EC2 GAHP will now respect the value of the environment variable
\Env{X509\_CERT\_DIR} and the configuration variable
\Macro{GSI\_DAEMON\_TRUSTED\_CA\_DIR} for \emph{all} secure connections.
\Ticket{2823}

\item Condor will avoid selecting down (disabled) network interfaces.  Previously Condor could select a down interface over an up (active) interface.
\Ticket{2893}

\item Made logic in the \Condor{negotiator} that computes submitter limits 
properly aware of the configuration variable
\Macro{NEGOTIATOR\_CONSIDER\_PREEMPTION}.
\Ticket{2952}


\item Condor no longer back-dates file modification times by 3 minutes
when transferring job input files into the job spool directory or the job
execute directory.
\Ticket{2423}

\item Fixed a bug in which the use of a pipe in the configuration file 
on Windows platforms would cause a visible console window 
to show up whenever the configuration was read.
\Ticket{1534}

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item Machine ClassAd attribute string values relating to \Attr{OpSys} have
been documented for Scientific Linux platforms.
\Ticket{2366}

\end{itemize}


